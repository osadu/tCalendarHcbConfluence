(this.webpackJsonpeventcalendar=this.webpackJsonpeventcalendar||[]).push([[0],{25:function(e,t,a){e.exports={errorBlock:"errors_errorBlock__M8nsh",errorMessages:"errors_errorMessages__2kkpv"}},26:function(e,t,a){e.exports={successBlock:"success_successBlock__2xYP2",successMessages:"success_successMessages__16Jk9"}},44:function(e,t,a){e.exports=a(75)},49:function(e,t,a){},50:function(e,t,a){},56:function(e,t,a){},74:function(e,t,a){},75:function(e,t,a){"use strict";a.r(t);var n=a(5),r=a.n(n),s=a(12),o=a.n(s),c=(a(49),a(11)),l=a(38),d=a(39),i=a(41),u=a(40),m=(a(50),a(83)),E=a(27),f=a(79),p=a(80),v=a(81),h=a(82),g=a(84),N=a(0),C=function(e){return Object(N.X)(a(51),a(52),a(53),a(54)),N.q.load(a(55)),r.a.createElement(m.a,{height:"650px",width:"82%",selectedDate:new Date,eventSettings:{dataSource:e.issues},currentView:"Month",readonly:!0,locale:"ru",firstDayOfWeek:1,popupOpen:e.onPopupOpen,popupClose:e.onPopupClose},r.a.createElement(E.b,{services:[f.a,p.a,v.a,h.a,g.a]}))};a(56);function b(){return e="context-path",window.AJS.Meta.get(e);var e}function S(){return window.AJS}"undefined"==typeof window.AJS&&(window.AJS={Meta:{get:function(e){return"user-locale"===e?"en-US":e}}});var w=function(e){return Object(n.useEffect)((function(){var t=S();e.events.map((function(e,a){return t.$("#tCalendarDropDown"+(a+1)).dropDown("Standard"),null}))}),[e.events]),r.a.createElement("div",{className:"tCalendarEvents"},r.a.createElement("div",{className:"tCalendarEventsTitle"},r.a.createElement("h4",null,r.a.createElement("b",null,"Deployment Plan")),r.a.createElement("ul",{id:"tCalendarDropDown",className:"styled-parent"},r.a.createElement("li",{className:"aui-dd-parent"},r.a.createElement("button",{className:"aui-button aui-dd-trigger",id:"dropdown-trigger"},r.a.createElement("img",{src:b()+"/download/resources/kz.hcb.tCalendarsHcbConfluence.tCalendarsHcbConfluence:tCalendarsHcbConluence-resources/images/tCalendarEventsMore.png",alt:""})),r.a.createElement("ul",{className:"aui-dropdown"},r.a.createElement("li",{className:"dropdown-item",onClick:e.addEvent},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u0431\u044b\u0442\u0438\u0435"))))),r.a.createElement("ul",{className:"tCalendarEventsList"},e.events.map((function(t,a){return r.a.createElement("li",{key:t.id,"data-index":a,onClick:e.handleClickEventLi,className:e.selectedIndex===a?"active":""},r.a.createElement("p",null,r.a.createElement("img",{className:"jiraIssueImg",src:b()+"/download/resources/kz.hcb.tCalendarsHcbConfluence.tCalendarsHcbConfluence:tCalendarsHcbConluence-resources/images/tCalendarJiraIssue.png",alt:""}),t.eventName),r.a.createElement("ul",{id:"tCalendarDropDown"+(a+1),className:"styled-parent"},r.a.createElement("li",{className:"aui-dd-parent"},r.a.createElement("button",{className:"aui-button aui-dd-trigger",id:"dropdown-trigger"},r.a.createElement("img",{src:b()+"/download/resources/kz.hcb.tCalendarsHcbConfluence.tCalendarsHcbConfluence:tCalendarsHcbConluence-resources/images/tCalendarEventsMore.png",alt:""})),r.a.createElement("ul",{className:"aui-dropdown"},r.a.createElement("li",{className:"dropdown-item","data-id":t.id,"data-eventname":t.eventName,"data-filtername":t.filterName,onClick:e.updateEvent},"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"),r.a.createElement("li",{className:"dropdown-item","data-id":t.id,"data-index":a,onClick:e.deleteEvent},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c")))))}))))},F=a(16),_=a.n(F),M=b()+"/rest/tCalendarsHcbConfluence/1/",y="http://localhost:2990/jira/rest/tCalendarsHcbJira/1/",k=function(e,t){return _.a.post(M+"createEvent",{eventName:e,filterName:t}).then((function(e){return e.data}))},x=function(){return _.a.get(M+"getEvents").then((function(e){return e.data}))},I=function(e){return _.a.delete(M+"deleteEvent/"+e).then((function(e){return e.data}))},D=function(e,t,a){return _.a.put(M+"updateEvent",{id:e,eventName:t,filterName:a}).then((function(e){return e.data}))},A=function(e){return _.a.get(y+"getFilterJqlByNameAnonym?filterName="+e).then((function(e){return e.data.jql}))},O=function(e){return _.a.get(y+"getJiraIssuesByFilterNameAnonym?filterName="+e).then((function(e){return e.data.issues}))},j=a(25),T=a.n(j),B=function(e){var t=e.errors;return r.a.createElement("div",{className:T.a.errorBlock},r.a.createElement("ul",{className:T.a.errorMessages},t.map((function(e,t){return r.a.createElement("li",{key:t},e)}))))},H=a(26),U=a.n(H),P=function(e){var t=e.messages;return r.a.createElement("div",{className:U.a.successBlock},r.a.createElement("ul",{className:U.a.successMessages},t.map((function(e,t){return r.a.createElement("li",{key:t},e)}))))},J=function(e){return r.a.createElement("section",{id:"addUpdateEvent-dialog",className:"aui-dialog2 aui-dialog2-small aui-layer",role:"dialog","aria-hidden":"true"},r.a.createElement("header",{className:"aui-dialog2-header"},r.a.createElement("a",{href:"#",className:"aui-dialog2-header-close","aria-label":"close"},r.a.createElement("span",{className:"aui-icon aui-icon-small aui-iconfont-close-dialog"}))),r.a.createElement("div",{className:"aui-dialog2-content"},e.errors.length>0&&r.a.createElement(B,{errors:e.errors}),e.success.length>0&&r.a.createElement(P,{messages:e.success}),r.a.createElement("form",{className:"aui",onSubmit:e.formSubmit},r.a.createElement("div",{className:"field-group"},r.a.createElement("label",{htmlFor:"eventName"},"\u0418\u043c\u044f \u0441\u043e\u0431\u044b\u0442\u0438\u0438",r.a.createElement("span",{className:"aui-icon icon-required"},"(required)")),r.a.createElement("input",{className:"text medium-field",type:"text",id:"eventName",placeholder:"\u0418\u043c\u044f \u0441\u043e\u0431\u044b\u0442\u0438\u0438",value:e.eventName,onChange:e.handleEventNameChange})),r.a.createElement("div",{className:"field-group"},r.a.createElement("label",{htmlFor:"filterName"},"\u0418\u043c\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430",r.a.createElement("span",{className:"aui-icon icon-required"},"(required)")),r.a.createElement("input",{className:"text medium-field",type:"text",id:"filterName",placeholder:"\u0418\u043c\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430",value:e.filterName,onChange:e.handleFilterNameChange})),r.a.createElement("div",{className:"buttons-container"},r.a.createElement("div",{className:"buttons"},r.a.createElement("input",{className:"button submit",type:"submit",value:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c",id:"comment-save-button"}))))),r.a.createElement("footer",{className:"aui-dialog2-footer"},r.a.createElement("div",{className:"aui-dialog2-footer-actions"},r.a.createElement("button",{id:"dialog-submit-button",className:"aui-button aui-button-primary",onClick:e.AddUpdateEventFormCloseButton},"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"))))},L=(a(74),function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={events:[],calendarMainErrors:[],calendarModalFormErrors:[],successEvent:[],formEventId:"0",formEventName:"",formFilterName:"",issues:[],selectedIndex:0},e._getEvents=function(){x().then((function(t){new Promise((function(a){e.setState({events:t.responseObject},(function(){a()}))})).then((function(){t.responseObject.length>0?e._getIssues(e.state.selectedIndex):e.setState({issues:[]})}))})).catch((function(t){t.response.data.errorText&&e.setState({calendarMainErrors:[].concat(Object(c.a)(e.state.calendarMainErrors),[t.response.data.errorText])})}))},e._getIssues=function(t){O(e.state.events[t].filterName).then((function(a){e.setState({selectedIndex:t,issues:a.map((function(e){return{Id:Number.parseInt(e.id),Subject:e.key,StartTime:new Date(e.fields.duedate+"T00:00:00.000+0600"),EndTime:new Date(e.fields.duedate+"T00:00:00.000+0600"),Description:e.fields.description,Status:e.fields.status.name,Creator:e.fields.creator.displayName,Assignee:null===e.fields.assignee?"\u041d\u0435 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u043e":e.fields.assignee.displayName,Reference:"http://localhost:2990/jira/browse/"+e.key,IsAllDay:!1}}))})}))},e._resetAddUpdateEventForm=function(){e.setState({formEventId:"0",formEventName:"",formFilterName:""})},e._closeModal=function(){e._resetAddUpdateEventForm(),S().dialog2("#addUpdateEvent-dialog").hide()},e._setStateAfterDeleteEvent=function(t){new Promise((function(a){e.setState({selectedIndex:t},(function(){a()}))})).then((function(){e._getEvents()}))},e._resetSuccessEventMessageAfterSomeSeconds=function(t){setTimeout((function(){e.setState({successEvent:[]})}),t)},e._createCustomFieldElement=function(e,t,a){var n=document.createElement("div");return n.className="customFields",n.innerHTML=a?"<b>"+e+'</b>: <a href="'+t+'" style="margin-left:5px">\u041e\u0442\u043a\u0440\u044b\u0442\u044c</a>':"<b>"+e+"</b>: "+t,n},e.onPopupOpen=function(t){t.element.getElementsByClassName("e-popup-content")[0].appendChild(e._createCustomFieldElement("\u0410\u0432\u0442\u043e\u0440",t.data.Creator,!1)),t.element.getElementsByClassName("e-popup-content")[0].appendChild(e._createCustomFieldElement("\u0418\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c",t.data.Assignee,!1)),t.element.getElementsByClassName("e-popup-content")[0].appendChild(e._createCustomFieldElement("\u0421\u0442\u0430\u0442\u0443\u0441",t.data.Status,!1)),t.element.getElementsByClassName("e-popup-content")[0].appendChild(e._createCustomFieldElement("\u0417\u0430\u043f\u0440\u043e\u0441 \u0432 Jira",t.data.Reference,!0))},e.onPopupClose=function(e){},e.handleFormSubmit=function(t){t.preventDefault();var a=[];e.state.formEventName||(a=[].concat(Object(c.a)(a),["\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0438\u043c\u044f \u0441\u043e\u0431\u0438\u0442\u0438\u0438"])),e.state.formFilterName||(a=[].concat(Object(c.a)(a),["\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0438\u043c\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430"])),a.length>0?e.setState({calendarModalFormErrors:a}):A(e.state.formFilterName).then((function(){"0"===e.state.formEventId?k(e.state.formEventName,e.state.formFilterName).then((function(t){e.setState({successEvent:[].concat(Object(c.a)(e.state.successEvent),["\u0423\u0441\u043f\u0435\u0448\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e"])}),e._closeModal(),e._getEvents(),e._resetSuccessEventMessageAfterSomeSeconds(3e3)})).catch((function(t){t.response.data.errorText&&e.setState({calendarModalFormErrors:[].concat(Object(c.a)(e.state.calendarModalFormErrors),[t.response.data.errorText])})})):D(e.state.formEventId,e.state.formEventName,e.state.formFilterName).then((function(t){e.setState({successEvent:[].concat(Object(c.a)(e.state.successEvent),["\u0423\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d"])}),e._closeModal(),e._getEvents(),e._resetSuccessEventMessageAfterSomeSeconds(3e3)})).catch((function(t){t.response.data.errorText&&e.setState({calendarModalFormErrors:[].concat(Object(c.a)(e.state.calendarModalFormErrors),[t.response.data.errorText])})}))})).catch((function(t){t.response.data.message&&e.setState({calendarModalFormErrors:[].concat(Object(c.a)(e.state.calendarModalFormErrors),[t.response.data.message])})}))},e.handleClickEventLi=function(t){e._getIssues(Number.parseInt(t.currentTarget.dataset.index||"0"))},e.handleDeleteEvent=function(t){t.stopPropagation();var a=Number.parseInt(t.currentTarget.dataset.index||"0");I(t.currentTarget.dataset.id).then((function(t){e.state.selectedIndex===a?e._setStateAfterDeleteEvent(0):e.state.selectedIndex>a?e._setStateAfterDeleteEvent(e.state.selectedIndex-1):e._getEvents(),e.setState({successEvent:[].concat(Object(c.a)(e.state.successEvent),["\u0423\u0441\u043f\u0435\u0448\u043d\u043e \u0443\u0434\u0430\u043b\u0435\u043d"])})})).catch((function(t){t.response.data.errorText&&e.setState({calendarMainErrors:[].concat(Object(c.a)(e.state.calendarMainErrors),[t.response.data.errorText])})}))},e.handleUpdateEvent=function(t){e.setState({formEventId:t.currentTarget.dataset.id,formEventName:t.currentTarget.dataset.eventname,formFilterName:t.currentTarget.dataset.filtername}),S().dialog2("#addUpdateEvent-dialog").show()},e.handleAddEvent=function(t){e._resetAddUpdateEventForm(),S().dialog2("#addUpdateEvent-dialog").show()},e.AddUpdateEventFormCloseButton=function(t){t.preventDefault(),e._closeModal()},e.handleEventNameChange=function(t){e.setState({formEventName:t.currentTarget.value})},e.handleFilterNameChange=function(t){e.setState({formFilterName:t.currentTarget.value,calendarModalFormErrors:[]})},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=S();this._getEvents(),e.$("#tCalendarDropDown").dropDown("Standard")}},{key:"render",value:function(){var e=this.state,t=e.events,a=e.formEventId,n=e.formEventName,s=e.formFilterName,o=e.selectedIndex,c=e.issues,l=e.calendarModalFormErrors,d=e.successEvent;return r.a.createElement("div",{className:"tCalendarsHcbBody"},r.a.createElement(C,{onPopupOpen:this.onPopupOpen,onPopupClose:this.onPopupClose,issues:c}),r.a.createElement(w,{events:t,addEvent:this.handleAddEvent,updateEvent:this.handleUpdateEvent,deleteEvent:this.handleDeleteEvent,handleClickEventLi:this.handleClickEventLi,selectedIndex:o}),r.a.createElement("div",{className:"modals"},r.a.createElement(J,{id:a,eventName:n,filterName:s,handleEventNameChange:this.handleEventNameChange,handleFilterNameChange:this.handleFilterNameChange,AddUpdateEventFormCloseButton:this.AddUpdateEventFormCloseButton,formSubmit:this.handleFormSubmit,success:d,errors:l})))}}]),a}(r.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));document.addEventListener("DOMContentLoaded",(function(e){o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(L,null)),document.getElementById("tCalendarsHcbConfluence"))})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[44,1,2]]]);