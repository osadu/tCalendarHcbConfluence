(this.webpackJsonpeventcalendar=this.webpackJsonpeventcalendar||[]).push([[0],{42:function(e,t,a){e.exports=a(72)},47:function(e,t,a){},48:function(e,t,a){},54:function(e,t,a){},72:function(e,t,a){"use strict";a.r(t);var n=a(5),r=a.n(n),s=a(12),o=a.n(s),l=(a(47),a(11)),c=a(36),d=a(37),i=a(39),u=a(38),m=(a(48),a(80)),E=a(25),v=a(76),f=a(77),p=a(78),h=a(79),N=a(81),g=a(0),b=function(e){return Object(g.X)(a(49),a(50),a(51),a(52)),g.q.load(a(53)),r.a.createElement(m.a,{height:"550px",width:"82%",selectedDate:new Date,eventSettings:{dataSource:e.issues},currentView:"Month",readonly:!0,locale:"ru",firstDayOfWeek:1,popupOpen:e.onPopupOpen},r.a.createElement(E.b,{services:[v.a,f.a,p.a,h.a,N.a]}))};a(54);function C(){return e="context-path",window.AJS.Meta.get(e);var e}function w(){return window.AJS}"undefined"==typeof window.AJS&&(window.AJS={Meta:{get:function(e){return"user-locale"===e?"en-US":e}}});var S=function(e){return Object(n.useEffect)((function(){var t=w();e.events.map((function(e,a){return t.$("#tCalendarDropDown"+(a+1)).dropDown("Standard"),null}))}),[e.events]),r.a.createElement("div",{className:"tCalendarEvents"},r.a.createElement("div",{className:"tCalendarEventsTitle"},r.a.createElement("h4",null,r.a.createElement("b",null,"Deployment Plan")),r.a.createElement("ul",{id:"tCalendarDropDown",className:"styled-parent"},r.a.createElement("li",{className:"aui-dd-parent"},r.a.createElement("button",{className:"aui-button aui-dd-trigger",id:"dropdown-trigger"},r.a.createElement("img",{src:C()+"/download/resources/kz.hcb.tCalendarsHcbConfluence.tCalendarsHcbConfluence:tCalendarsHcbConluence-resources/images/tCalendarEventsMore.png",alt:""})),r.a.createElement("ul",{className:"aui-dropdown"},r.a.createElement("li",{className:"dropdown-item",onClick:e.addEvent},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u0431\u044b\u0442\u0438\u0435"))))),r.a.createElement("ul",{className:"tCalendarEventsList"},e.events.map((function(t,a){return r.a.createElement("li",{key:t.id,"data-index":a,onClick:e.handleClickEventLi,className:e.selectedIndex===a?"active":""},r.a.createElement("p",null,r.a.createElement("img",{className:"jiraIssueImg",src:C()+"/download/resources/kz.hcb.tCalendarsHcbConfluence.tCalendarsHcbConfluence:tCalendarsHcbConluence-resources/images/tCalendarJiraIssue.png",alt:""}),t.eventName),r.a.createElement("ul",{id:"tCalendarDropDown"+(a+1),className:"styled-parent"},r.a.createElement("li",{className:"aui-dd-parent"},r.a.createElement("button",{className:"aui-button aui-dd-trigger",id:"dropdown-trigger"},r.a.createElement("img",{src:C()+"/download/resources/kz.hcb.tCalendarsHcbConfluence.tCalendarsHcbConfluence:tCalendarsHcbConluence-resources/images/tCalendarEventsMore.png",alt:""})),r.a.createElement("ul",{className:"aui-dropdown"},r.a.createElement("li",{className:"dropdown-item","data-id":t.id,"data-eventname":t.eventName,"data-filtername":t.filterName,onClick:e.updateEvent},"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"),r.a.createElement("li",{className:"dropdown-item","data-id":t.id,"data-index":a,onClick:e.deleteEvent},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c")))))}))))},F=a(16),x=a.n(F),I=C()+"/rest/tCalendarsHcbConfluence/1/",y="http://localhost:2990/jira/rest/tCalendarsHcbJira/1/",D=function(e,t){return x.a.post(I+"createEvent",{eventName:e,filterName:t}).then((function(e){return e.data}))},O=function(){return x.a.get(I+"getEvents").then((function(e){return e.data}))},M=function(e){return x.a.delete(I+"deleteEvent/"+e).then((function(e){return e.data}))},k=function(e,t,a){return x.a.put(I+"updateEvent",{id:e,eventName:t,filterName:a}).then((function(e){return e.data}))},T=function(e){return x.a.get(y+"getJiraIssuesByFilterNameAnonym?filterName="+e).then((function(e){return e.data.issues}))},j=function(e){return r.a.createElement("section",{id:"addUpdateEvent-dialog",className:"aui-dialog2 aui-dialog2-small aui-layer",role:"dialog","aria-hidden":"true"},r.a.createElement("header",{className:"aui-dialog2-header"},r.a.createElement("a",{href:"#",className:"aui-dialog2-header-close","aria-label":"close"},r.a.createElement("span",{className:"aui-icon aui-icon-small aui-iconfont-close-dialog"}))),r.a.createElement("div",{className:"aui-dialog2-content"},r.a.createElement("form",{className:"aui",onSubmit:e.formSubmit},r.a.createElement("div",{className:"field-group"},r.a.createElement("label",{htmlFor:"eventName"},"\u0418\u043c\u044f \u0441\u043e\u0431\u044b\u0442\u0438\u0438",r.a.createElement("span",{className:"aui-icon icon-required"},"(required)")),r.a.createElement("input",{className:"text medium-field",type:"text",id:"eventName",placeholder:"\u0418\u043c\u044f \u0441\u043e\u0431\u044b\u0442\u0438\u0438",value:e.eventName,onChange:e.handleEventNameChange})),r.a.createElement("div",{className:"field-group"},r.a.createElement("label",{htmlFor:"filterName"},"\u0418\u043c\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430",r.a.createElement("span",{className:"aui-icon icon-required"},"(required)")),r.a.createElement("input",{className:"text medium-field",type:"text",id:"filterName",placeholder:"\u0418\u043c\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430",value:e.filterName,onChange:e.handleFilterNameChange})),r.a.createElement("div",{className:"buttons-container"},r.a.createElement("div",{className:"buttons"},r.a.createElement("input",{className:"button submit",type:"submit",value:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c",id:"comment-save-button"}))))),r.a.createElement("footer",{className:"aui-dialog2-footer"},r.a.createElement("div",{className:"aui-dialog2-footer-actions"},r.a.createElement("button",{id:"dialog-submit-button",className:"aui-button aui-button-primary",onClick:e.AddUpdateEventFormCloseButton},"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"))))},A=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={events:[],calendarMainErrors:[],calendarModalFormErrors:[],successEvent:[],formEventId:"0",formEventName:"",formFilterName:"",issues:[],selectedIndex:0},e._getEvents=function(){O().then((function(t){e.setState({events:t.responseObject},(function(){t.responseObject.length>0?e._getIssues(e.state.selectedIndex):e.setState({issues:[]})}))})).catch((function(t){t.response.data.errorText&&e.setState({calendarMainErrors:[].concat(Object(l.a)(e.state.calendarMainErrors),[t.response.data.errorText])})}))},e._getIssues=function(t){T(e.state.events[t].filterName).then((function(a){e.setState({selectedIndex:t,issues:a.map((function(e){return{Id:Number.parseInt(e.id),Subject:e.key,StartTime:new Date(e.fields.duedate+"T00:00:00.000+0600"),EndTime:new Date(e.fields.duedate+"T00:00:00.000+0600"),Description:e.fields.description,Status:e.fields.status.name,Creator:e.fields.creator.displayName,IsAllDay:!1}}))})}))},e._resetAddUpdateEventForm=function(){e.setState({formEventId:"0",formEventName:"",formFilterName:""})},e._closeModal=function(){e._resetAddUpdateEventForm(),w().dialog2("#addUpdateEvent-dialog").hide()},e.onPopupOpen=function(e){console.log(e)},e.handleFormSubmit=function(t){t.preventDefault();var a=[];e.state.formEventName||(a=[].concat(Object(l.a)(a),["\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0438\u043c\u044f \u0441\u043e\u0431\u0438\u0442\u0438\u0438"])),e.state.formFilterName||(a=[].concat(Object(l.a)(a),["\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0438\u043c\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430"])),a.length>0?e.setState({calendarModalFormErrors:a}):"0"===e.state.formEventId?D(e.state.formEventName,e.state.formFilterName).then((function(t){e.setState({successEvent:[].concat(Object(l.a)(e.state.successEvent),["\u0423\u0441\u043f\u0435\u0448\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e"])}),e._closeModal(),e._getEvents()})).catch((function(t){t.response.data.errorText&&e.setState({calendarModalFormErrors:[].concat(Object(l.a)(e.state.calendarModalFormErrors),[t.response.data.errorText])})})):k(e.state.formEventId,e.state.formEventName,e.state.formFilterName).then((function(t){e.setState({successEvent:[].concat(Object(l.a)(e.state.successEvent),["\u0423\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d"])}),e._closeModal(),e._getEvents()})).catch((function(t){t.response.data.errorText&&e.setState({calendarModalFormErrors:[].concat(Object(l.a)(e.state.calendarModalFormErrors),[t.response.data.errorText])})}))},e.handleClickEventLi=function(t){e._getIssues(Number.parseInt(t.currentTarget.dataset.index||"0"))},e.handleDeleteEvent=function(t){var a=Number.parseInt(t.currentTarget.dataset.index||"0");M(t.currentTarget.dataset.id).then((function(t){e.state.selectedIndex===a&&e.setState({selectedIndex:0}),e._getEvents(),e.setState({successEvent:[].concat(Object(l.a)(e.state.successEvent),["\u0423\u0441\u043f\u0435\u0448\u043d\u043e \u0443\u0434\u0430\u043b\u0435\u043d"])})})).catch((function(t){t.response.data.errorText&&e.setState({calendarMainErrors:[].concat(Object(l.a)(e.state.calendarMainErrors),[t.response.data.errorText])})}))},e.handleUpdateEvent=function(t){e.setState({formEventId:t.currentTarget.dataset.id,formEventName:t.currentTarget.dataset.eventname,formFilterName:t.currentTarget.dataset.filtername}),w().dialog2("#addUpdateEvent-dialog").show()},e.handleAddEvent=function(t){e._resetAddUpdateEventForm(),w().dialog2("#addUpdateEvent-dialog").show()},e.AddUpdateEventFormCloseButton=function(t){t.preventDefault(),e._closeModal()},e.handleEventNameChange=function(t){e.setState({formEventName:t.currentTarget.value})},e.handleFilterNameChange=function(t){e.setState({formFilterName:t.currentTarget.value})},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=w();this._getEvents(),e.$("#tCalendarDropDown").dropDown("Standard")}},{key:"render",value:function(){var e=this.state,t=e.events,a=e.formEventId,n=e.formEventName,s=e.formFilterName,o=e.selectedIndex,l=e.issues;return r.a.createElement("div",{className:"tCalendarsHcbBody"},r.a.createElement(b,{onPopupOpen:this.onPopupOpen,issues:l}),r.a.createElement(S,{events:t,addEvent:this.handleAddEvent,updateEvent:this.handleUpdateEvent,deleteEvent:this.handleDeleteEvent,handleClickEventLi:this.handleClickEventLi,selectedIndex:o}),r.a.createElement("div",{className:"modals"},r.a.createElement(j,{id:a,eventName:n,filterName:s,handleEventNameChange:this.handleEventNameChange,handleFilterNameChange:this.handleFilterNameChange,AddUpdateEventFormCloseButton:this.AddUpdateEventFormCloseButton,formSubmit:this.handleFormSubmit})))}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));document.addEventListener("DOMContentLoaded",(function(e){o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(A,null)),document.getElementById("tCalendarsHcbConfluence"))})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[42,1,2]]]);